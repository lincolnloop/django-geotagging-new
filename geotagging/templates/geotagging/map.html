{% block map_container %}
    <div id="map-canvas-{{ map_id }}"
            style="width: {{ width }}px; height: {{ height }}px;"
         class="geotagging-map-googlemap">
    </div>
{% endblock %}

{% block map_js %}
    <!-- Map creation script -->
    <script type="text/javascript">
        function initialize_map_{{ map_id }}() {
            var latlng = new google.maps.LatLng({{ latlng }});
            var mapElem = document.getElementById("map-canvas-{{ map_id }}");

            {% block map_options_js %}
            var mapOptions = {
                zoom: {{ zoom }},
                center: latlng,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };
            {% endblock %}

            var map = new google.maps.Map(mapElem, mapOptions);

            {% block extra_map_js %}
            {% for marker in markers %}
            var marker = new google.maps.Marker({
                position: new google.maps.LatLng({{ marker.latlng }}),
                map: map,
                title: "{% if marker.object %}{{ marker.object.get_title }}{% endif %}"
            });
            {% endfor %}

            var mc = new MarkerClusterer(map);
            {% endblock %}
        }

        {% block map_loading_js %}
        // initialize the map after page loading
        google.maps.event.addDomListener(window, 'load', initialize_map_{{ map_id }});
        {% endblock %}
    </script>
{% endblock %}
